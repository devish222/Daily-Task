<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IBPS 2025-26 All Exams Important Dates & Task Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F2F2F2;
            color: #003F5C;
        }
        .card {
            background-color: #ffffff;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .timeline-container {
            position: relative;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px 0;
        }
        .timeline-container::after {
            content: '';
            position: absolute;
            width: 4px;
            background-color: #6B9DB3;
            top: 0;
            bottom: 0;
            left: 50%;
            margin-left: -2px;
        }
        .timeline-item {
            padding: 10px 40px;
            position: relative;
            background-color: inherit;
            width: 50%;
        }
        .timeline-item::after {
            content: '';
            position: absolute;
            width: 25px;
            height: 25px;
            right: -12.5px;
            background-color: #003F5C;
            border: 4px solid white;
            top: 15px;
            border-radius: 50%;
            z-index: 1;
        }
        .left {
            left: 0;
        }
        .right {
            left: 50%;
        }
        .left::before {
            content: " ";
            height: 0;
            position: absolute;
            top: 22px;
            width: 0;
            z-index: 1;
            right: 30px;
            border: medium solid white;
            border-width: 10px 0 10px 10px;
            border-color: transparent transparent transparent white;
        }
        .right::before {
            content: " ";
            height: 0;
            position: absolute;
            top: 22px;
            width: 0;
            z-index: 1;
            left: 30px;
            border: medium solid white;
            border-width: 10px 10px 10px 0;
            border-color: transparent white transparent transparent;
        }
        .right::after {
            left: -12.5px;
        }
        .content {
            padding: 20px 30px;
            background-color: white;
            position: relative;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        @media screen and (max-width: 767px) {
            .timeline-container::after {
                left: 31px;
            }
            .timeline-item {
                width: 100%;
                padding-left: 70px;
                padding-right: 25px;
            }
            .timeline-item::before {
                left: 60px;
                border-width: 10px 10px 10px 0;
                border-color: transparent white transparent transparent;
            }
            .left::after, .right::after {
                left: 18px;
            }
            .left, .right {
                left: 0%;
            }
        }
        .task-completed {
            text-decoration: line-through;
            color: #6B9DB3;
        }
        /* Table row styling for readability */
        table tbody tr:nth-child(odd) {
            background-color: #F8F8F8; /* Lighter background for odd rows */
        }
        table tbody tr:nth-child(even) {
            background-color: #FFFFFF; /* White background for even rows */
        }
        /* Removed hover for mobile optimization */
        .message-box {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #4CAF50; /* Green for success */
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }
        .message-box.show {
            opacity: 1;
        }
        /* Modal styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            visibility: hidden;
            opacity: 0;
            transition: visibility 0s, opacity 0.3s ease-in-out;
        }
        .modal.show {
            visibility: visible;
            opacity: 1;
        }
        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            width: 90%;
            max-width: 500px;
            position: relative;
        }
        .modal-close-btn {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            font-size: 1.5rem;
            cursor: pointer;
            color: #6B9DB3;
        }
        /* Ensure buttons always have their base color, and active state applies on press */
        button {
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            outline: none; /* Remove default focus outline */
        }
        button:focus {
            box-shadow: 0 0 0 2px rgba(0, 63, 92, 0.5); /* Example: dark blue ring */
        }

        /* Button color definitions */
        .btn-dark-blue {
            background-color: #003F5C;
            color: white;
        }
        .btn-dark-blue:active {
            background-color: #002A3D; /* Darker shade for active state */
        }

        .btn-green {
            background-color: #4CAF50; /* Green */
            color: white;
        }
        .btn-green:active {
            background-color: #45A049; /* Darker green for active state */
        }

        .btn-blue {
            background-color: #3B82F6; /* Standard Blue */
            color: white;
        }
        .btn-blue:active {
            background-color: #2563EB; /* Darker blue for active state */
        }

        .btn-red {
            background-color: #EF4444; /* Standard Red */
            color: white;
        }
        .btn-red:active {
            background-color: #DC2626; /* Darker red for active state */
        }

        .btn-gray {
            background-color: #D1D5DB; /* Gray for cancel */
            color: #4B5563;
        }
        .btn-gray:active {
            background-color: #9CA3AF; /* Darker gray for active state */
        }

        /* Specific styles for filter buttons (All, Completed, Uncompleted) */
        .btn-filter-selected {
            background-color: #003F5C; /* Dark blue when selected */
            color: white;
        }
        .btn-filter-selected:active {
            background-color: #002A3D; /* Darker shade when selected and active */
        }

        .btn-filter-unselected {
            background-color: white; /* White when unselected */
            color: #003F5C; /* Dark text when unselected */
            border: 1px solid #003F5C; /* Optional: add a border to unselected for clarity */
        }
        .btn-filter-unselected:active {
            background-color: #E0E0E0; /* Light gray when unselected and active */
            color: #003F5C;
        }


        .cursor-pointer.active-category-card { /* Active state for category cards */
            background-color: #6B9DB3;
            color: white;
        }
        .total-time-box {
            background-color: #A7D5E5;
            border-radius: 0.75rem;
            padding: 0.75rem 1.5rem;
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: #003F5C;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            min-width: 100px;
        }

        /* Responsive layout for buttons and total time */
        .schedule-controls {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 1rem; /* Space between items */
            margin-bottom: 1rem;
        }
        @media (min-width: 768px) { /* On medium screens and up, make it a row */
            .schedule-controls {
                flex-direction: row;
            }
        }
    </style>
</head>
<body>

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">

        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-extrabold text-[#003F5C] mb-4">Your 2025-26 Banking Exam Calendar & Task Tracker</h1>
            <p class="text-lg text-[#366E8A]">A visual guide to all key dates for Graduate-level IBPS exams and your personalized task manager.</p>
        </header>

        <main>
            <section id="exam-timeline" class="mb-12">
                <h2 class="text-3xl font-bold text-center mb-8 text-[#003F5C]">Important Exam Dates</h2>
                <div class="timeline-container">
                    <div class="timeline-item left">
                        <div class="content">
                            <h3 class="font-bold text-xl text-[#003F5C] mb-2">IBPS Specialist Officer (IT)</h3>
                            <p class="text-sm text-[#366E8A]">Notification Release: June 30, 2025</p>
                            <p class="text-sm text-[#366E8A]">Online Application: July 1 - July 21, 2025</p>
                            <p class="text-sm text-[#366E8A]">Prelims Exam: August 30, 2025</p>
                            <p class="text-sm text-[#366E8A]">Mains Exam: November 9, 2025</p>
                            <p class="text-sm text-[#366E8A]">Interview: To be announced</p>
                            <p class="text-sm text-[#366E8A]">Provisional Allotment: To be announced</p>
                        </div>
                    </div>

                    <div class="timeline-item right">
                        <div class="content">
                            <h3 class="font-bold text-xl text-[#003F5C] mb-2">IBPS Probationary Officer (PO)</h3>
                            <p class="text-sm text-[#366E8A]">Notification Release: June 30, 2025</p>
                            <p class="text-sm text-[#366E8A]">Online Application: July 1 - July 21, 2025</p>
                            <p class="text-sm text-[#366E8A]">Prelims Exam: August 17, 23, 24, 2025</p>
                            <p class="text-sm text-[#366E8A]">Mains Exam: October 12, 2025</p>
                            <p class="text-sm text-[#366E8A]">Interview: November-December 2025</p>
                            <p class="text-sm text-[#366E8A]">Final Result: January-February 2026</p>
                        </div>
                    </div>

                    <div class="timeline-item left">
                        <div class="content">
                            <h3 class="font-bold text-xl text-[#003F5C] mb-2">IBPS Clerk (Customer Service Associates)</h3>
                            <p class="text-sm text-[#366E8A]">Notification Release: Expected July 2025</p>
                            <p class="text-sm text-[#366E8A]">Online Application: Expected July 3 - August 3, 2025</p>
                            <p class="text-sm text-[#366E8A]">Prelims Exam: October 4, 5, 11, 2025</p>
                            <p class="text-sm text-[#366E8A]">Mains Exam: November 29, 2025</p>
                        </div>
                    </div>

                    <div class="timeline-item right">
                        <div class="content">
                            <h3 class="font-bold text-xl text-[#003F5C] mb-2">IBPS RRB Officer Scale I (PO)</h3>
                            <p class="text-sm text-[#366E8A]">Notification Release: Expected September 2025</p>
                            <p class="text-sm text-[#366E8A]">Online Application: Expected July 31 - August 29, 2025</p>
                            <p class="text-sm text-[#366E8A]">Prelims Exam: November 22, 23, 2025</p>
                            <p class="text-sm text-[#366E8A]">Mains Exam: December 28, 2025</p>
                        </div>
                    </div>

                    <div class="timeline-item left">
                        <div class="content">
                            <h3 class="font-bold text-xl text-[#003F5C] mb-2">IBPS RRB Office Assistant (Clerk)</h3>
                            <p class="text-sm text-[#366E8A]">Prelims Exam: December 5, 7, 13, 14, 2025</p>
                            <p class="text-sm text-[#366E8A]">Mains Exam: February 1, 2026</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="daily-study-schedule" class="mb-12">
                <h2 class="text-3xl font-bold text-center mb-8 text-[#003F5C]">Your Detailed Daily Study Schedule</h2>
                <div class="card overflow-x-auto">
                    <table class="min-w-full bg-white rounded-lg overflow-hidden">
                        <thead class="bg-[#A7D5E5] text-[#003F5C] uppercase text-sm leading-normal">
                            <tr>
                                <th class="py-3 px-6 text-left">Time Slot</th>
                                <th class="py-3 px-6 text-left">Category Focus</th>
                                <th class="py-3 px-6 text-left">Specific Topics/Activities</th>
                                <th class="py-3 px-6 text-left">Daily Practice Targets</th>
                            </tr>
                        </thead>
                        <tbody class="text-[#366E8A] text-sm font-light">
                            <tr>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">New tricks (02:00 AM - 04:30 AM)</td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">Maths tricks and Reasoning important data</td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">Simplification/Approximation/Number Series (Practice 30-40 questions)</td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">4 Viral maths videos</td>
                            </tr>
                            <tr>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">Morning (07:30 AM - 10:30 AM)</td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">Reasoning Ability (3 hours)</td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">7:30 AM - 9:00 AM: Puzzles (2-3 sets daily) & Seating Arrangements (2-3 sets daily)</td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">60-80 questions</td>
                            </tr>
                            <tr>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]"></td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]"></td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">9:00 AM - 10:00 AM: Syllogism/Inequalities (Practice 20-30 questions)</td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">(Emphasis on 2-3 sets of high-level puzzles/seating arrangements)</td>
                            </tr>
                            <tr>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]"></td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]"></td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">10:00 AM - 10:30AM: Miscellaneous Reasoning (Blood Relations, Direction Sense, Coding-Decoding) (Practice 20-30 questions)</td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]"></td>
                            </tr>
                            <tr>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">Late Morning (10:30 AM - 12:30 PM)</td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">Quantitative Aptitude (2 hours)</td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">10:30 AM - 11:30 AM: Data Interpretation (2-3 sets daily)</td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">50-70 questions(Including 2-3 DI sets and a mix of other topics)</td>
                            </tr>
                            <tr>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]"></td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]"></td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">11:30 AM - 12:30 PM: Simplification/Approximation/Number Series (Practice 30-40 questions)</td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]"></td>
                            </tr>
                            <tr>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">Lunch & Rest (12:30 PM - 01:30 PM)</td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]"></td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]"></td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]"></td>
                            </tr>
                            <tr>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">Afternoon (1:30 PM - 5:00 PM)</td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">English Language (3.5 hours)</td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">1:30 PM - 4:00 PM: Grammar Rules</td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">40-50 questions</td>
                            </tr>
                            <tr>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]"></td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]"></td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">4:00 PM - 5:00 PM: Reading Comprehension (2-3 passages daily)</td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">(Including 2-3 RC passages and a mix of grammar/vocabulary)</td>
                            </tr>
                            <tr>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">Short Break (5:00 PM - 5:30 PM)</td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]"></td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]"></td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]"></td>
                            </tr>
                            <tr>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">Evening (5:30 PM - 8:30 PM)</td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">Professional Knowledge (IT) / General Awareness & Banking Awareness (2 hours)</td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">5:30 PM - 6:30 PM: IT Professional Knowledge (Focus on 1-2 topics from Mains syllabus daily, e.g., DBMS, Networking fundamentals)</td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">15-20 conceptual questions for IT PK</td>
                            </tr>
                            <tr>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]"></td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]"></td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">6:30 PM - 8:30 PM: Current Affairs & Banking Awareness (Daily reading of editorials, monthly PDFs, banking terms)</td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">Continuous learning, note-taking</td>
                            </tr>
                            <tr>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">Night (8:30 PM - 10:00 PM)</td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">Mock Test Analysis / Revision (1 hour)</td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">Alternate days: Full-length Prelims Mock Test (timed, 1 hour)</td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">Detailed analysis of mock tests, revision of weak areas</td>
                            </tr>
                            <tr>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]"></td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]"></td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">On non-mock days: Detailed analysis of previous mock tests, revisiting weak areas, revising formulas/shortcuts</td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]"></td>
                            </tr>
                            <tr>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]"></td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]"></td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]">Daily: Quick revision of notes, especially for high-frequency questions</td>
                                <td class="py-3 px-6 border-b border-[#F2F2F2]"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="task-manager" class="mb-12">
                <h2 class="text-3xl font-bold text-center mb-8 text-[#003F5C]">Your Study Task Manager</h2>

                <div class="card mb-8">
                    <h3 class="text-xl font-bold mb-4 text-[#003F5C]">Add New Task</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                        <div>
                            <label for="taskNameInput" class="block text-sm font-medium text-[#366E8A] mb-1">Task Name</label>
                            <input type="text" id="taskNameInput" placeholder="e.g., Complete DI set"
                                class="w-full p-2 border border-[#A7D5E5] rounded-md focus:ring-2 focus:ring-[#6B9DB3] focus:border-transparent outline-none">
                        </div>
                        <div>
                            <label for="categoryInput" class="block text-sm font-medium text-[#366E8A] mb-1">Category of Task</label>
                            <select id="categoryInput"
                                class="w-full p-2 border border-[#A7D5E5] rounded-md focus:ring-2 focus:ring-[#6B9DB3] focus:border-transparent outline-none bg-white">
                                <option value="">Select Category</option>
                                <option value="Quant">Quant</option>
                                <option value="Reasoning">Reasoning</option>
                                <option value="English">English</option>
                                <option value="CA">Current Affairs</option>
                                <option value="Computer Knowledge">Computer Knowledge</option>
                                <option value="Other Task">Other Task</option>
                            </select>
                        </div>
                        <div>
                            <label for="timeTakenInput" class="block text-sm font-medium text-[#366E8A] mb-1">Time Taken (HH:MM)</label>
                            <input type="text" id="timeTakenInput" placeholder="e.g., 01:30"
                                class="w-full p-2 border border-[#A7D5E5] rounded-md focus:ring-2 focus:ring-[#6B9DB3] focus:border-transparent outline-none"
                                pattern="^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$" title="Time in HH:MM format (e.g., 01:30)">
                        </div>
                        <div class="flex items-end col-span-full md:col-span-1">
                            <button id="addTaskBtn"
                                class="w-full btn-green py-2 px-4 rounded-md text-white font-bold">
                                Add Task
                            </button>
                        </div>
                    </div>
                </div>

                <div class="card mb-8">
                    <h3 class="text-xl font-bold mb-4 text-[#003F5C]">Your Schedule</h3>
                    <div class="schedule-controls">
                        <button id="allTasksViewBtn" class="py-2 px-4 rounded-md">All Tasks</button>
                        <button id="completedTasksViewBtn" class="py-2 px-4 rounded-md">Completed Tasks</button>
                        <button id="uncompletedTasksViewBtn" class="py-2 px-4 rounded-md">Uncompleted Tasks</button>
                        <div id="totalTimeForCurrentView" class="total-time-box">
                            00:00
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table id="scheduleTable" class="min-w-full bg-white rounded-lg overflow-hidden">
                            <thead class="bg-[#A7D5E5] text-[#003F5C] uppercase text-sm leading-normal">
                                <tr>
                                    <th class="py-3 px-6 text-left">Task</th>
                                    <th class="py-3 px-6 text-left">Category of Task</th>
                                    <th class="py-3 px-6 text-left">Due Date</th>
                                    <th class="py-3 px-6 text-left">Time Taken</th>
                                    <th class="py-3 px-6 text-center">Status</th>
                                    <th class="py-3 px-6 text-center">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="scheduleTableBody" class="text-[#366E8A] text-sm font-light">
                                <!-- Tasks will be rendered here by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="card mb-8">
                    <h3 class="text-xl font-bold mb-4 text-[#003F5C]">Category Progress</h3>
                    <div id="categoryProgressContainer" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4 text-center">
                        <!-- Category progress cards will be rendered here by JavaScript -->
                    </div>
                </div>

                <div class="card mb-8">
                    <h3 class="text-xl font-bold mb-4 text-[#003F5C]">Your Progress Dashboard</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-center">
                        <div class="p-4 bg-[#A7D5E5] rounded-md">
                            <p class="text-sm font-semibold text-[#003F5C]">Total Tasks</p>
                            <p id="totalTasksDisplay" class="text-3xl font-bold text-[#003F5C]">0</p>
                        </div>
                        <div class="p-4 bg-[#A7D5E5] rounded-md">
                            <p class="text-sm font-semibold text-[#003F5C]">Completed Tasks</p>
                            <p id="completedTasksDisplay" class="text-3xl font-bold text-[#003F5C]">0</p>
                        </div>
                        <div class="p-4 bg-[#A7D5E5] rounded-md">
                            <p class="text-sm font-semibold text-[#003F5C]">Completion Rate</p>
                            <p id="completionPercentageDisplay" class="text-3xl font-bold text-[#003F5C]">0%</p>
                        </div>
                        <!-- Removed Total Time Spent from here -->
                    </div>
                    <div class="flex justify-center space-x-4 mt-6">
                        <button id="dailyReportBtn" class="btn-dark-blue py-2 px-4 rounded-md">Daily Report</button>
                        <button id="weeklyReportBtn" class="btn-dark-blue py-2 px-4 rounded-md">Weekly Report</button>
                    </div>
                    <div class="flex justify-center mt-6">
                        <button id="saveDataBtn" class="btn-green py-2 px-4 rounded-md">Save Data (CSV)</button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Edit Task Modal -->
    <div id="editTaskModal" class="modal">
        <div class="modal-content">
            <span class="modal-close-btn" onclick="closeEditModal()">&times;</span>
            <h3 class="text-xl font-bold mb-4 text-[#003F5C]">Edit Task</h3>
            <div class="mb-4">
                <label for="editTaskNameInput" class="block text-sm font-medium text-[#366E8A] mb-1">Task Name</label>
                <input type="text" id="editTaskNameInput"
                    class="w-full p-2 border border-[#A7D5E5] rounded-md focus:ring-2 focus:ring-[#6B9DB3] focus:border-transparent outline-none">
            </div>
            <div class="mb-4">
                <label for="editCategoryInput" class="block text-sm font-medium text-[#366E8A] mb-1">Category of Task</label>
                <select id="editCategoryInput"
                    class="w-full p-2 border border-[#A7D5E5] rounded-md focus:ring-2 focus:ring-[#6B9DB3] focus:border-transparent outline-none bg-white">
                    <option value="">Select Category</option>
                    <option value="Quant">Quant</option>
                    <option value="Reasoning">Reasoning</option>
                    <option value="English">English</option>
                    <option value="CA">Current Affairs</option>
                    <option value="Computer Knowledge">Computer Knowledge</option>
                    <option value="Other Task">Other Task</option>
                </select>
            </div>
            <div class="mb-6">
                <label for="editTimeTakenInput" class="block text-sm font-medium text-[#366E8A] mb-1">Time Taken (HH:MM)</label>
                <input type="text" id="editTimeTakenInput" placeholder="e.g., 01:30"
                    class="w-full p-2 border border-[#A7D5E5] rounded-md focus:ring-2 focus:ring-[#6B9DB3] focus:border-transparent outline-none"
                    pattern="^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$" title="Time in HH:MM format (e.g., 01:30)">
            </div>
            <div class="flex justify-end space-x-4">
                <button id="updateTaskBtn"
                    class="btn-dark-blue py-2 px-4 rounded-md">
                    Update Task
                </button>
                <button onclick="closeEditModal()"
                    class="btn-gray py-2 px-4 rounded-md">
                    Cancel
                </button>
            </div>
        </div>
    </div>


    <script>
        let tasks = [];
        let currentCategoryFilter = 'all'; // Default to show all tasks
        let currentCompletionFilter = 'all'; // 'all', 'completed', 'uncompleted'

        let currentEditingTaskId = null; // To store the ID of the task being edited

        const categories = ["Quant", "Reasoning", "English", "CA", "Computer Knowledge", "Other Task"];

        // Helper to format date for display (DD/MM/YY)
        function formatDateForDisplay(dateString) {
            if (!dateString) return '';
            const [year, month, day] = dateString.split('-');
            return `${day}/${month}/${year.slice(2)}`; // Slice to get last two digits of year
        }

        // Helper to get today's date in YYYY-MM-DD format
        function getTodayDateString() {
            const today = new Date();
            return today.toISOString().split('T')[0];
        }

        // Helper to convert HH:MM string to total minutes
        function convertHhMmToMinutes(hhMmString) {
            if (!hhMmString || hhMmString === '00:00') return 0;
            const parts = hhMmString.split(':');
            if (parts.length !== 2) return 0; // Invalid format
            const hours = parseInt(parts[0], 10);
            const minutes = parseInt(parts[1], 10);
            if (isNaN(hours) || isNaN(minutes) || hours < 0 || minutes < 0 || minutes >= 60) return 0; // Invalid numbers
            return hours * 60 + minutes;
        }

        // Helper to convert total minutes to HH:MM string
        function convertMinutesToHhMm(totalMinutes) {
            if (totalMinutes === 0) return '00:00';
            const hours = Math.floor(totalMinutes / 60);
            const minutes = totalMinutes % 60;
            return `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}`;
        }

        // Function to save tasks to localStorage
        function saveTasks() {
            localStorage.setItem('ibpsTasks', JSON.stringify(tasks));
            localStorage.setItem('lastAccessDate', getTodayDateString()); // Update last access date
        }

        // Function to load tasks from localStorage and apply daily cleanup logic
        function loadTasks() {
            const storedTasks = localStorage.getItem('ibpsTasks');
            if (storedTasks) {
                tasks = JSON.parse(storedTasks);
            }

            const todayString = getTodayDateString();
            const lastAccessDate = localStorage.getItem('lastAccessDate');

            // If it's a new day, filter out completed tasks from previous days
            if (lastAccessDate && lastAccessDate !== todayString) {
                tasks = tasks.filter(task => {
                    // Keep tasks that are not completed OR are due today/in the future
                    return !task.completed || task.originalDate >= todayString;
                });
            }
            saveTasks(); // Save tasks (after any filtering) and update lastAccessDate
        }

        // Function to filter tasks based on the current category and completion filter
        function getFilteredTasks() {
            let filtered = tasks;

            // Apply category filter first
            if (currentCategoryFilter !== 'all') {
                filtered = filtered.filter(task => task.category === currentCategoryFilter);
            }

            // Apply completion filter
            if (currentCompletionFilter === 'completed') {
                filtered = filtered.filter(task => task.completed);
            } else if (currentCompletionFilter === 'uncompleted') {
                filtered = filtered.filter(task => !task.completed);
            }
            // If currentCompletionFilter is 'all', no further filtering is needed

            // Sort tasks by due date (ascending)
            filtered.sort((a, b) => {
                if (a.originalDate < b.originalDate) return -1;
                if (a.originalDate > b.originalDate) return 1;
                return 0; // If dates are the same, maintain original order
            });

            return filtered;
        }

        // Function to render tasks in the table and update dashboard
        function renderTasks() {
            const tableBody = document.getElementById('scheduleTableBody');
            tableBody.innerHTML = ''; // Clear existing rows

            const filteredTasks = getFilteredTasks();

            if (filteredTasks.length === 0) {
                const row = tableBody.insertRow();
                const cell = row.insertCell();
                cell.colSpan = 6; // Span across all columns (Task, Category, Due Date, Time Taken, Status, Actions)
                cell.className = 'py-3 px-6 text-center text-[#366E8A]';
                cell.textContent = 'No tasks to display for this view.';
            } else {
                filteredTasks.forEach(task => {
                    const row = tableBody.insertRow();
                    row.className = `border-b border-[#F2F2F2] ${task.completed ? 'task-completed' : ''}`;

                    const taskCell = row.insertCell();
                    taskCell.className = 'py-3 px-6 text-left';
                    taskCell.textContent = task.name;

                    const categoryCell = row.insertCell();
                    categoryCell.className = 'py-3 px-6 text-left';
                    categoryCell.textContent = task.category;

                    const dateCell = row.insertCell();
                    dateCell.className = 'py-3 px-6 text-left';
                    dateCell.textContent = task.displayDate; // Use displayDate

                    const timeTakenCell = row.insertCell();
                    timeTakenCell.className = 'py-3 px-6 text-left';
                    timeTakenCell.textContent = convertMinutesToHhMm(task.timeTaken || 0); // Display formatted time

                    const statusCell = row.insertCell();
                    statusCell.className = 'py-3 px-6 text-center';
                    const checkbox = document.createElement('input');
                    checkbox.type = 'checkbox';
                    checkbox.checked = task.completed;
                    checkbox.className = 'form-checkbox h-5 w-5 text-[#003F5C] rounded focus:ring-[#003F5C]';
                    checkbox.dataset.taskId = task.id; // Store task ID
                    checkbox.addEventListener('change', toggleTaskCompletion);
                    statusCell.appendChild(checkbox);

                    const actionsCell = row.insertCell();
                    actionsCell.className = 'py-3 px-6 text-center flex space-x-2 justify-center'; // Added flex for buttons

                    // Edit Button
                    const editBtn = document.createElement('button');
                    editBtn.textContent = 'Edit';
                    editBtn.className = 'btn-blue py-1 px-3 rounded-md text-xs'; // Applied btn-blue
                    editBtn.dataset.taskId = task.id;
                    editBtn.addEventListener('click', () => openEditModal(task.id));
                    actionsCell.appendChild(editBtn);

                    // Delete Button
                    const deleteBtn = document.createElement('button');
                    deleteBtn.textContent = 'Delete';
                    deleteBtn.className = 'btn-red py-1 px-3 rounded-md text-xs ml-2'; // Applied btn-red and added margin
                    deleteBtn.dataset.taskId = task.id;
                    deleteBtn.addEventListener('click', deleteTask);
                    actionsCell.appendChild(deleteBtn);
                });
            }

            // Update dashboard based on ALL tasks (for overall progress)
            updateDashboard();
            renderCategoryProgressSummary(); // Always re-render category progress
            updateTotalTimeForCurrentView(filteredTasks); // Update total time for the tasks currently displayed
            updateFilterButtonStates(); // Update the visual state of filter buttons
        }

        // Function to update the "Total Time for Current View" display
        function updateTotalTimeForCurrentView(tasksToCount) {
            let totalTimeSpentMinutes = 0;
            tasksToCount.forEach(task => {
                totalTimeSpentMinutes += (task.timeTaken || 0);
            });
            const totalTimeSpentHhMm = convertMinutesToHhMm(totalTimeSpentMinutes);
            document.getElementById('totalTimeForCurrentView').textContent = totalTimeSpentHhMm; // Only show time, no text
        }

        // Function to update the visual state of the filter buttons
        function updateFilterButtonStates() {
            const allBtn = document.getElementById('allTasksViewBtn');
            const completedBtn = document.getElementById('completedTasksViewBtn');
            const uncompletedBtn = document.getElementById('uncompletedTasksViewBtn');

            // Reset all filter buttons to unselected state first
            allBtn.classList.remove('btn-filter-selected');
            allBtn.classList.add('btn-filter-unselected');
            completedBtn.classList.remove('btn-filter-selected');
            completedBtn.classList.add('btn-filter-unselected');
            uncompletedBtn.classList.remove('btn-filter-selected');
            uncompletedBtn.classList.add('btn-filter-unselected');


            // Add selected class to the currently active filter button
            if (currentCompletionFilter === 'all') {
                allBtn.classList.remove('btn-filter-unselected');
                allBtn.classList.add('btn-filter-selected');
            } else if (currentCompletionFilter === 'completed') {
                completedBtn.classList.remove('btn-filter-unselected');
                completedBtn.classList.add('btn-filter-selected');
            } else if (currentCompletionFilter === 'uncompleted') {
                uncompletedBtn.classList.remove('btn-filter-unselected');
                uncompletedBtn.classList.add('btn-filter-selected');
            }
        }


        // Function to add a new task
        function addTask() {
            const taskNameInput = document.getElementById('taskNameInput');
            const categoryInput = document.getElementById('categoryInput');
            const timeTakenInput = document.getElementById('timeTakenInput');

            const taskName = taskNameInput.value.trim();
            const category = categoryInput.value;
            const timeTaken = timeTakenInput.value.trim();

            if (taskName && category) {
                // Validate time format if provided
                if (timeTaken && !timeTakenInput.checkValidity()) {
                    const messageBox = document.createElement('div');
                    messageBox.className = 'fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-red-500 text-white p-4 rounded-md shadow-lg z-50';
                    messageBox.textContent = 'Please enter time in HH:MM format (e.g., 01:30).';
                    document.body.appendChild(messageBox);
                    setTimeout(() => {
                        messageBox.remove();
                    }, 3000);
                    return; // Stop function execution
                }

                const todayString = getTodayDateString();
                const newTask = {
                    id: crypto.randomUUID(), // Generate a unique ID
                    name: taskName,
                    category: category,
                    originalDate: todayString, // Automatically set to today
                    displayDate: formatDateForDisplay(todayString), // Formatted for display
                    completed: false,
                    timeTaken: convertHhMmToMinutes(timeTaken) // Store time in minutes
                };
                tasks.push(newTask);
                saveTasks();
                renderTasks(); // Re-render with current view
                taskNameInput.value = ''; // Clear input fields
                categoryInput.value = ''; // Reset category dropdown
                timeTakenInput.value = ''; // Clear time input
            } else {
                const messageBox = document.createElement('div');
                messageBox.className = 'fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-red-500 text-white p-4 rounded-md shadow-lg z-50';
                messageBox.textContent = 'Please enter a task name and select a category.';
                document.body.appendChild(messageBox);
                setTimeout(() => {
                    messageBox.remove();
                }, 3000);
            }
        }

        // Function to toggle task completion status
        function toggleTaskCompletion(event) {
            const taskId = event.target.dataset.taskId;
            const taskIndex = tasks.findIndex(task => task.id === taskId);
            if (taskIndex !== -1) {
                tasks[taskIndex].completed = event.target.checked;
                saveTasks();
                renderTasks(); // Re-render to apply line-through style and update dashboard
            }
        }

        // Function to delete a task
        function deleteTask(event) {
            const taskId = event.target.dataset.taskId;
            tasks = tasks.filter(task => task.id !== taskId);
            saveTasks();
            renderTasks();
        }

        // Function to open the edit modal
        function openEditModal(taskId) {
            currentEditingTaskId = taskId;
            const task = tasks.find(t => t.id === taskId);

            if (task) {
                document.getElementById('editTaskNameInput').value = task.name;
                document.getElementById('editCategoryInput').value = task.category;
                document.getElementById('editTimeTakenInput').value = convertMinutesToHhMm(task.timeTaken || 0); // Pre-fill formatted time
                document.getElementById('editTaskModal').classList.add('show');
            }
        }

        // Function to close the edit modal
        function closeEditModal() {
            document.getElementById('editTaskModal').classList.remove('show');
            currentEditingTaskId = null; // Clear the editing task ID
        }

        // Function to update the edited task
        function updateEditedTask() {
            if (!currentEditingTaskId) return;

            const taskIndex = tasks.findIndex(task => task.id === currentEditingTaskId);
            if (taskIndex !== -1) {
                const updatedName = document.getElementById('editTaskNameInput').value.trim();
                const updatedCategory = document.getElementById('editCategoryInput').value;
                const updatedTimeTaken = document.getElementById('editTimeTakenInput').value.trim();

                // Validate time format if provided
                if (updatedTimeTaken && !document.getElementById('editTimeTakenInput').checkValidity()) {
                    const messageBox = document.createElement('div');
                    messageBox.className = 'fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-red-500 text-white p-4 rounded-md shadow-lg z-50';
                    messageBox.textContent = 'Please enter time in HH:MM format (e.g., 01:30).';
                    document.body.appendChild(messageBox);
                    setTimeout(() => {
                        messageBox.remove();
                    }, 3000);
                    return; // Stop function execution
                }

                if (updatedName && updatedCategory) {
                    tasks[taskIndex].name = updatedName;
                    tasks[taskIndex].category = updatedCategory;
                    tasks[taskIndex].timeTaken = convertHhMmToMinutes(updatedTimeTaken); // Update time in minutes
                    saveTasks();
                    renderTasks();
                    closeEditModal();
                } else {
                    const messageBox = document.createElement('div');
                    messageBox.className = 'fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 -translate-y-1/2 bg-red-500 text-white p-4 rounded-md shadow-lg z-50';
                    messageBox.textContent = 'Task name and category cannot be empty.';
                    document.body.appendChild(messageBox);
                    setTimeout(() => {
                        messageBox.remove();
                    }, 3000);
                }
            }
        }


        // Function to update the dashboard metrics based on ALL tasks (overall progress)
        function updateDashboard() {
            const totalTasks = tasks.length;
            const completedTasks = tasks.filter(task => task.completed).length;
            const completionPercentage = totalTasks === 0 ? 0 : Math.round((completedTasks / totalTasks) * 100);

            document.getElementById('totalTasksDisplay').textContent = totalTasks;
            document.getElementById('completedTasksDisplay').textContent = completedTasks;
            document.getElementById('completionPercentageDisplay').textContent = `${completionPercentage}%`;
        }

        // Function to render category progress summary
        function renderCategoryProgressSummary() {
            const container = document.getElementById('categoryProgressContainer');
            container.innerHTML = ''; // Clear existing cards

            const categoryData = {};
            categories.forEach(category => {
                categoryData[category] = { total: 0, completed: 0 };
            });

            tasks.forEach(task => {
                if (categoryData[task.category]) {
                    categoryData[task.category].total++;
                    if (task.completed) {
                        categoryData[task.category].completed++;
                    }
                }
            });

            categories.forEach(category => {
                const total = categoryData[category].total;
                const completed = categoryData[category].completed;
                const percentage = total === 0 ? 0 : Math.round((completed / total) * 100);

                const card = document.createElement('div');
                // Use a different class for category cards to distinguish from filter buttons
                card.className = 'p-4 bg-[#A7D5E5] rounded-md cursor-pointer active:bg-[#6B9DB3] active:text-white transition duration-200 ease-in-out';
                card.innerHTML = `
                    <p class="text-sm font-semibold text-[#003F5C]">${category}</p>
                    <p class="text-xl font-bold text-[#003F5C]">${completed} / ${total}</p>
                    <p class="text-xs text-[#366E8A]">${percentage}% Completed</p>
                `;
                card.dataset.categoryFilter = category;
                card.addEventListener('click', (event) => {
                    // Remove 'active-category-card' from all category cards
                    document.querySelectorAll('#categoryProgressContainer .active-category-card').forEach(c => c.classList.remove('active-category-card'));
                    // Add 'active-category-card' to the clicked card
                    event.currentTarget.classList.add('active-category-card');

                    currentCategoryFilter = event.currentTarget.dataset.categoryFilter;
                    currentCompletionFilter = 'all'; // Reset completion filter when a category is selected
                    renderTasks();
                });
                container.appendChild(card);
            });
        }


        // Function to show report in a modal
        function showReportModal(content, title) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white p-6 rounded-lg shadow-xl max-w-lg w-full relative">
                    <button class="absolute top-3 right-3 text-gray-500 active:text-gray-700 text-xl font-bold" onclick="this.closest('.fixed').remove()">&times;</button>
                    <h2 class="text-2xl font-bold text-[#003F5C] mb-4">${title}</h2>
                    <div class="text-[#366E8A] overflow-y-auto max-h-96">
                        ${content}
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Report functions
        function generateDailyReport() {
            const todayString = getTodayDateString();
            // Daily report should include all tasks due today, regardless of completion status
            const dailyTasks = tasks.filter(task => task.originalDate === todayString);
            const totalDaily = dailyTasks.length;
            const completedDaily = dailyTasks.filter(task => task.completed).length;

            let reportContent = `<h3 class="text-xl font-bold text-[#003F5C] mb-2">Daily Report for ${formatDateForDisplay(todayString)}</h3>`;
            reportContent += `<p>Total Tasks: ${totalDaily}</p>`;
            reportContent += `<p>Completed Tasks: ${completedDaily}</p>`;
            reportContent += `<p>Completion Rate: ${totalDaily === 0 ? 0 : Math.round((completedDaily / totalDaily) * 100)}%</p>`;
            reportContent += `<h4 class="font-semibold mt-4">Tasks:</h4><ul>`;
            if (dailyTasks.length === 0) {
                reportContent += `<li>No tasks for today.</li>`;
            } else {
                dailyTasks.forEach(task => {
                    reportContent += `<li class="${task.completed ? 'task-completed' : ''}">${task.name} (${task.category}) (Due: ${task.displayDate}) - ${task.completed ? 'Completed' : 'Pending'}</li>`;
                });
            }
            reportContent += `</ul>`;

            showReportModal(reportContent, 'Daily Report');
        }

        function generateWeeklyReport() {
            // Helper to get the start of the week (Monday) in YYYY-MM-DD format
            function getStartOfWeek(dateString) {
                const d = new Date(dateString);
                const day = d.getDay(); // 0 for Sunday, 1 for Monday
                const diff = d.getDate() - day + (day === 0 ? -6 : 1); // Adjust for Monday start
                const startOfWeek = new Date(d.setDate(diff));
                return startOfWeek.toISOString().split('T')[0];
            }

            const todayString = getTodayDateString();
            const startOfWeekString = getStartOfWeek(todayString);
            const endOfWeek = new Date(startOfWeekString);
            endOfWeek.setDate(endOfWeek.getDate() + 6);
            const endOfWeekString = endOfWeek.toISOString().split('T')[0];

            const weeklyTasks = tasks.filter(task => {
                return task.originalDate >= startOfWeekString && task.originalDate <= endOfWeekString;
            });

            const totalWeekly = weeklyTasks.length;
            const completedWeekly = weeklyTasks.filter(task => task.completed).length;

            let reportContent = `<h3 class="text-xl font-bold text-[#003F5C] mb-2">Weekly Report (${formatDateForDisplay(startOfWeekString)} - ${formatDateForDisplay(endOfWeekString)})</h3>`;
            reportContent += `<p>Total Tasks: ${totalWeekly}</p>`;
            reportContent += `<p>Completed Tasks: ${completedWeekly}</p>`;
            reportContent += `<p>Completion Rate: ${totalWeekly === 0 ? 0 : Math.round((completedWeekly / totalWeekly) * 100)}%</p>`;
            reportContent += `<h4 class="font-semibold mt-4">Tasks:</h4><ul>`;
            if (weeklyTasks.length === 0) {
                reportContent += `<li>No tasks for this week.</li>`;
            } else {
                weeklyTasks.forEach(task => {
                    reportContent += `<li class="${task.completed ? 'task-completed' : ''}">${task.name} (${task.category}) (Due: ${task.displayDate}) - ${task.completed ? 'Completed' : 'Pending'}</li>`;
                });
            }
            reportContent += `</ul>`;

            showReportModal(reportContent, 'Weekly Report');
        }

        // Function to export tasks to CSV
        function exportTasksToCSV() {
            let csvContent = "data:text/csv;charset=utf-8,";
            csvContent += "Task Name,Category of Task,Original Due Date (YYYY-MM-DD),Display Date (DD/MM/YY),Time Taken (HH:MM),Completed\n"; // Headers for tasks

            tasks.forEach(task => {
                // Escape commas and wrap in double quotes if necessary for CSV
                const taskNameEscaped = `"${task.name.replace(/"/g, '""')}"`;
                const categoryEscaped = `"${task.category.replace(/"/g, '""')}"`;
                const timeTakenHhMm = convertMinutesToHhMm(task.timeTaken || 0);
                let row = `${taskNameEscaped},${categoryEscaped},${task.originalDate},${task.displayDate},${timeTakenHhMm},${task.completed ? 'Yes' : 'No'}`;
                csvContent += row + "\n";
            });

            // Add overall dashboard summary (for all tasks in the system)
            const totalTasksOverall = tasks.length;
            const completedTasksOverall = tasks.filter(task => task.completed).length;
            const completionPercentageOverall = totalTasksOverall === 0 ? 0 : Math.round((completedTasksOverall / totalTasksOverall) * 100);

            let totalTimeSpentMinutesOverall = 0;
            tasks.forEach(task => {
                totalTimeSpentMinutesOverall += (task.timeTaken || 0);
            });
            const totalTimeSpentHhMmOverall = convertMinutesToHhMm(totalTimeSpentMinutesOverall);


            csvContent += "\n"; // Add a blank line for separation
            csvContent += "--- Overall Progress Summary (All Tasks) ---\n";
            csvContent += `Total Tasks (All Time):,${totalTasksOverall}\n`;
            csvContent += `Completed Tasks (All Time):,${completedTasksOverall}\n`;
            csvContent += `Overall Completion Rate:,${completionPercentageOverall}%\n`;
            csvContent += `Total Time Spent (All Time):,${totalTimeSpentHhMmOverall}\n`; // New line for total time

            // Add category-wise progress summary
            csvContent += "\n";
            csvContent += "--- Category-wise Progress Summary ---\n";
            csvContent += "Category,Total Tasks,Completed Tasks,Completion Rate\n"; // New headers for category summary

            const categoryData = {};
            categories.forEach(category => {
                categoryData[category] = { total: 0, completed: 0 };
            });

            tasks.forEach(task => {
                if (categoryData[task.category]) {
                    categoryData[task.category].total++;
                    if (task.completed) {
                        categoryData[task.category].completed++;
                    }
                }
            });

            categories.forEach(category => {
                const total = categoryData[category].total;
                const completed = categoryData[category].completed;
                const percentage = total === 0 ? 0 : Math.round((completed / total) * 100);
                csvContent += `${category},${total},${completed},${percentage}%\n`; // Format as Category, Total, Completed, Percentage
            });


            const today = new Date();
            const timestamp = today.getFullYear() +
                              String(today.getMonth() + 1).padStart(2, '0') +
                              String(today.getDate()).padStart(2, '0') + '_' +
                              String(today.getHours()).padStart(2, '0') +
                              String(today.getMinutes()).padStart(2, '0') +
                              String(today.getSeconds()).padStart(2, '0');
            const filename = `ibps_tasks_data_${timestamp}.csv`;

            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", filename);
            document.body.appendChild(link); // Required for Firefox
            link.click();
            document.body.removeChild(link); // Clean up

            // Show confirmation message
            const messageBox = document.createElement('div');
            messageBox.className = 'message-box';
            messageBox.textContent = `Data saved to ${filename}!`;
            document.body.appendChild(messageBox);
            setTimeout(() => {
                messageBox.classList.add('show');
            }, 10); // Small delay to trigger transition
            setTimeout(() => {
                messageBox.classList.remove('show');
                setTimeout(() => messageBox.remove(), 500); // Remove after transition
            }, 3000); // Hide after 3 seconds
        }

        // Event listeners and initial load
        document.addEventListener('DOMContentLoaded', () => {
            loadTasks();
            renderTasks(); // Initial render for all tasks view (which calls updateFilterButtonStates)

            document.getElementById('addTaskBtn').addEventListener('click', addTask);
            document.getElementById('updateTaskBtn').addEventListener('click', updateEditedTask); // Update button in modal

            // View selection buttons
            document.getElementById('allTasksViewBtn').addEventListener('click', () => {
                currentCategoryFilter = 'all'; // Reset category filter
                currentCompletionFilter = 'all'; // Show all tasks (completed and uncompleted)
                // Remove 'active-category-card' from all category cards
                document.querySelectorAll('#categoryProgressContainer .active-category-card').forEach(c => c.classList.remove('active-category-card'));
                renderTasks();
            });

            document.getElementById('completedTasksViewBtn').addEventListener('click', () => {
                currentCategoryFilter = 'all'; // Reset category filter
                currentCompletionFilter = 'completed'; // Show only completed tasks
                document.querySelectorAll('#categoryProgressContainer .active-category-card').forEach(c => c.classList.remove('active-category-card'));
                renderTasks();
            });

            document.getElementById('uncompletedTasksViewBtn').addEventListener('click', () => {
                currentCategoryFilter = 'all'; // Reset category filter
                currentCompletionFilter = 'uncompleted'; // Show only uncompleted tasks
                document.querySelectorAll('#categoryProgressContainer .active-category-card').forEach(c => c.classList.remove('active-category-card'));
                renderTasks();
            });


            // Report buttons
            document.getElementById('dailyReportBtn').addEventListener('click', generateDailyReport);
            document.getElementById('weeklyReportBtn').addEventListener('click', generateWeeklyReport);

            // Save Data button
            document.getElementById('saveDataBtn').addEventListener('click', exportTasksToCSV);
        });
    </script>
</body>
</html>
